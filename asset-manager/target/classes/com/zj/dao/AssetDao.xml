<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zj.dao.AssetDao">

<!--    新增传感器-->
    <insert id="insertSensorDao" parameterType="com.zj.entity.Sensor">
        insert into  t_sensor (
                               sensorName,
                               sensorCode,
                               protocal,
                               sensorModel_id ,
                               item_id  ,
                               orga_id)
        values (

                #{sensorName},
                #{sensorCode},
                #{protocal},
                #{sensorModelId},
                #{itemId},
                #{orgaId}
               )

    </insert>

<!--    删除传感器-->
    <delete id="deleteSensorDao" >
        delete from t_sensor where id = #{id}
    </delete>

<!--    查询传感器的结果集映射-->
    <resultMap id="selectSensor" type="com.zj.entity.Sensor">
        <id column="id" property="id"/>
        <result column="sensorName" property="sensorName"/>
        <result column="sensorCode" property="sensorCode"/>
        <result column="protocal" property="protocal"/>
<!--       sensor___>sensorModel -->
        <association property="sensorModel" javaType="com.zj.entity.SensorModel">
            <id column="sensorModelId" property="id"/>
            <result column="deviceName" property="deviceName"/>
            <result column="deviceType" property="deviceType"/>
            <result column="deviceNumber" property="deviceNumber"/>
            <result column="createTime" property="createTime"/>
            <result column="protocol" property="protocol"/>
            <result column="dataPointName" property="dataPointName"/>
            <result column="lowThreshold" property="lowThreshold"/>
            <result column="highThreshold" property="highThreshold"/>
            <result column="dataPointExtra" property="dataPointExtra"/>
        </association>
<!--        sensor__>item  -->
        <association property="item" javaType="com.zj.entity.Item">
            <id column="itemId" property="id"/>
            <result column="name" property="name"/>
            <result column="number" property="number"/>
            <result column="addr" property="addr"/>
            <result column="phone" property="phone"/>
            <result column="ItemCreateTime" property="createTime"/>
          <!--  item ___> organize -->
            <association property="organize"  javaType="com.zj.entity.Organize">
                <id column="orgaId" property="id"/>
                <result column="OName" property="name"/>
                <result column="parentId" property="parentId"/>
                <result column="location" property="location"/>
                <result column="orgaNum" property="orgaNumber"/>
                <result column="ext" property="ext"/>
            </association>
        </association>
    </resultMap>
    <select id="selectSensorDao" resultMap="selectSensor">
        select
            s.id,
            s.sensorName,
            s.sensorCode,
            s.protocal,
#               sensor
            s.sensorModel_id as  sensorModelId ,
               sm.deviceName,
               sm.deviceType,
               sm.deviceNumber,
               sm.createTime,
               sm.protocol,
               sm.dataPointName,
               sm.lowThreshold,
               sm.highThreshold,
               sm.dataPointExtra,
#               item
            s.item_id as itemId,
               i.name,
               i.number,
               i.addr,
               i.phone,
               i.createTime as ItemCreateTime,
#               organize
               i.orga_id as orgaId,
               o.name as OName,
               o.parent_id as parentId,
               o.type_id as typeId,
               o.location ,
               o.orga_number as orgaNum,
               o.ext
        from t_sensor s join t_sensor_model sm on  sm.id = s.sensorModel_id
                        join t_item i on i.id = s.item_id
                        join organize o on o.id = i.orga_id
    </select>

</mapper>