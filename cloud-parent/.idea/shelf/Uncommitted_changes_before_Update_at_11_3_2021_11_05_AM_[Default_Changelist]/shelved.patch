Index: ../sys-manager/src/main/java/com/zj/service/SysServiceImpl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.zj.service;\r\n\r\nimport com.github.pagehelper.PageHelper;\r\nimport com.zj.dao.SysDao;\r\nimport com.zj.entity.*;\r\nimport com.zj.util.Md5;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Repository;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpSession;\r\nimport java.io.UnsupportedEncodingException;\r\nimport java.security.NoSuchAlgorithmException;\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * @author zhoujian\r\n */\r\n@Service\r\npublic class SysServiceImpl implements SysService {\r\n    @Autowired\r\n    private SysDao sysDao;\r\n\r\n    /**\r\n     * 用户登录\r\n     */\r\n    @Override\r\n    public UserManager userLoginService(User user, HttpServletRequest request) {\r\n        String password = user.getPassword();\r\n        //md5加密\r\n        try {\r\n            String ps = Md5.EncoderByMd5(password);\r\n            System.out.println(ps);\r\n            user.setPassword(ps);\r\n        } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {\r\n            e.printStackTrace();\r\n        }\r\n        //查询\r\n        UserManager userManager = sysDao.userSelect(user);\r\n        //正确的用户放入redissession\r\n        if (null != userManager){\r\n            HttpSession session = request.getSession();\r\n            session.setAttribute(\"user\",userManager);\r\n\r\n        }\r\n        return userManager;\r\n    }\r\n\r\n    /**\r\n     * 机构查询\r\n     * @param pageNo\r\n     * @param pageSize\r\n     * @param orgName\r\n     * @return\r\n     */\r\n    @Override\r\n    public List<Organize> findOrganzieService(String pageNo, String pageSize, String orgName) {\r\n        Integer num = Integer.valueOf(pageNo);\r\n        Integer size = Integer.valueOf(pageSize);\r\n        PageHelper.startPage((num-1)*size,size);\r\n        return sysDao.organizeSelect(orgName);\r\n    }\r\n\r\n    /**\r\n     * 添加机构\r\n     * @return\r\n     */\r\n    @Override\r\n    public CommonResponse<Object> addOrganizeService(Organize organize) {\r\n        CommonResponse<Object> response = new CommonResponse<>();\r\n        if (sysDao.organizeInsert(organize)){\r\n            response.setMsg(\"添加成功！\");\r\n            return response;\r\n        }else {\r\n            response.setMsg(\"添加失败！\");\r\n            return  response;\r\n        }\r\n\r\n    }\r\n\r\n    @Override\r\n    public List<Role> findRoleService() {\r\n        return null;\r\n    }\r\n\r\n    @Override\r\n    public boolean deleteRoleService(int id) {\r\n        return sysDao.roleDelete(id);\r\n    }\r\n\r\n    /**\r\n     * 角色查询\r\n     * @param pageNo 页码\r\n     * @param pageSize 每一=页数据量\r\n     * @param roleName 角色字段\r\n     * @return 结果集\r\n     */\r\n    @Override\r\n    public List<Role> findRoleService(String pageNo,String pageSize,String roleName) {\r\n        return sysDao.roleSelect(roleName);\r\n    }\r\n\r\n    /**\r\n     * 角色添加\r\n     * @param role 参数\r\n     * @return 返回结果\r\n     */\r\n    @Override\r\n    public CommonResponse<Object> addRoleService(Role role) {\r\n        CommonResponse<Object> response = new CommonResponse<>();\r\n        if (sysDao.roleInsert(role)){\r\n            response.setStatus(200);\r\n            response.setMsg(\"添加成功！\");\r\n            return response;\r\n        }else {\r\n            response.setStatus(400);\r\n            response.setMsg(\"添加失败！\");\r\n            return  response;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 查询所有权限\r\n     * @return 权限结果集\r\n     */\r\n    @Override\r\n    public List<Perm> findPermService() {\r\n        return sysDao.permSelect();\r\n    }\r\n\r\n    /**\r\n     * 给角色添加权限\r\n     * @param roleId\r\n     * @param permId\r\n     * @return\r\n     */\r\n    @Override\r\n    public CommonResponse<Object> addRolePermService(String roleId, String permId) {\r\n        CommonResponse<Object> response = new CommonResponse<>();\r\n        if (sysDao.rolePermInsert(roleId,permId)){\r\n            response.setStatus(200);\r\n            response.setMsg(\"添加成功！\");\r\n            return response;\r\n        }else {\r\n            response.setStatus(400);\r\n            response.setMsg(\"添加失败！\");\r\n            return response;\r\n        }\r\n    }\r\n\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- ../sys-manager/src/main/java/com/zj/service/SysServiceImpl.java	(revision 935cd21e20a74c7c78d509369121f109c8831c57)
+++ ../sys-manager/src/main/java/com/zj/service/SysServiceImpl.java	(date 1635907930576)
@@ -5,7 +5,6 @@
 import com.zj.entity.*;
 import com.zj.util.Md5;
 import org.springframework.beans.factory.annotation.Autowired;
-import org.springframework.stereotype.Repository;
 import org.springframework.stereotype.Service;
 
 import javax.servlet.http.HttpServletRequest;
@@ -80,11 +79,20 @@
 
     }
 
+    /**
+     * 查询角色
+     * @return
+     */
     @Override
     public List<Role> findRoleService() {
         return null;
     }
 
+    /**
+     * 删除角色
+     * @param id
+     * @return
+     */
     @Override
     public boolean deleteRoleService(int id) {
         return sysDao.roleDelete(id);
@@ -150,5 +158,4 @@
         }
     }
 
-
 }
Index: ../sys-manager/src/main/java/com/zj/dao/SysDao.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<!DOCTYPE mapper\r\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\r\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.zj.dao.SysDao\">\r\n<!--    用户登录sql-->\r\n    <resultMap id=\"user_map\" type=\"com.zj.entity.UserManager\">\r\n<!--        用户信息-->\r\n        <id column=\"id\" property=\"id\"/>\r\n        <result column=\"username\" property=\"username\"/>\r\n        <result column=\"password\" property=\"password\"/>\r\n        <result column=\"salt\" property=\"salt\"/>\r\n        <result column=\"phone\" property=\"phone\"/>\r\n<!--        用户所在的公司-->\r\n        <association property=\"o\" javaType=\"com.zj.entity.Organize\">\r\n            <id column=\"id\" property=\"id\"/>\r\n            <result column=\"organame\" property=\"name\"/>\r\n        </association>\r\n<!--       用户____> 角色表____>角色实体集 -->\r\n        <collection property=\"roles\" ofType=\"com.zj.entity.Role\">\r\n            <result column=\"rolename\" property=\"name\"/>\r\n            <result column=\"ext\" property=\"ext\"/>\r\n<!--         角色表____>权限表_____>权限实体集-->\r\n            <collection  property=\"perms\" ofType=\"com.zj.entity.Perm\">\r\n                <result column=\"permname\" property=\"name\"/>\r\n            </collection>\r\n        </collection>\r\n    </resultMap>\r\n    <select id=\"userSelect\" resultMap=\"user_map\">\r\n        SELECT\r\n            u.id,\r\n            u.username,\r\n            u.password,\r\n            u.salt,\r\n            u.phone,\r\n            o.NAME AS organame,\r\n            r.NAME AS rolename,\r\n            r.ext,\r\n            p.NAME AS permname\r\n        FROM\r\n            t_user u\r\n            LEFT JOIN organize o ON o.id = u.orga_id\r\n            LEFT JOIN t_user_role ur ON ur.userid = u.id\r\n            LEFT JOIN t_role r ON r.id = ur.roleid\r\n            LEFT JOIN t_role_perms rp ON rp.role_id = r.id\r\n            LEFT JOIN t_perms p ON p.id = rp.perm_id\r\n        where\r\n            u.username = #{username} and  u.password= #{password}\r\n    </select>\r\n\r\n<!--    机构查询根据机构名称模糊查询，支持分页，page-->\r\n    <resultMap id=\"orga_type_map\" type=\"com.zj.entity.Organize\">\r\n        <id column=\"id\" property=\"id\"/>\r\n        <result column=\"name\" property=\"name\"/>\r\n<!--        公司的父公司-->\r\n        <result column=\"parentorganame\" property=\"parentName\"/>\r\n       <result column=\"location\" property=\"location\"/>\r\n        <result column=\"organum\" property=\"orgaNumber\"/>\r\n        <result column=\"ext\" property=\"ext\"/>\r\n<!--        公司的类型-->\r\n        <association property=\"orgaType\" javaType=\"com.zj.entity.OrgaType\">\r\n            <result column=\"orgatypename\" property=\"name\"/>\r\n        </association>\r\n    </resultMap>\r\n    <select id=\"organizeSelect\" resultMap=\"orga_type_map\" >\r\n    SELECT\r\n        o1.id,\r\n        o1.name,\r\n        o2.name as parentorganame,\r\n        ot.name as orgatypename,\r\n        o1.location,\r\n        o1.orga_number as organum,\r\n        o1.ext\r\n    FROM\r\n        organize o1\r\n        JOIN orga_type ot ON ot.id = o1.id\r\n        left join organize o2 on o2.id = o1.parent_id\r\n\twhere o1.name like concat(#{orgName},'%')\r\n    </select>\r\n\r\n<!--    机构插入-->\r\n    <insert id=\"organizeInsert\" >\r\n        insert  into organize\r\n        (name , parent_id, type_id, location, orga_number, ext)\r\n        values\r\n        (#{name},#{parentId},#{typeId},#{location},#{orgaNumber},#{ext})\r\n    </insert>\r\n\r\n<!--    查询角色-->\r\n    <select id=\"roleSelect\" resultType=\"com.zj.entity.Role\">\r\n        select\r\n        id,name,ext from t_role\r\n        where name like concat(#{roleName},'%')\r\n    </select>\r\n\r\n<!--    新增角色-->\r\n    <insert id=\"RoleInsert\" >\r\n        insert into t_role\r\n        (name,ext)\r\n        values\r\n        (#{name},#{ext})\r\n    </insert>\r\n\r\n<!--    查询所用的权限-->\r\n    <select id=\"permSelect\" resultType=\"com.zj.entity.Perm\">\r\n        select id,name from t_perms\r\n    </select>\r\n\r\n<!--    角色权限添加-->\r\n    <insert id=\"rolePermInsert\" >\r\n        insert into t_role_perms\r\n        (role_id,perm_id)\r\n        values (#{roleId},#{permId})\r\n    </insert>\r\n\r\n    <delete id=\"roleDelete\">\r\n        DELETE t_role,\r\n            t_role_perms,\r\n            t_user_role\r\n        FROM\r\n\t    t_role\r\n\t        INNER JOIN t_role_perms ON t_role_perms.role_id = t_role.id\r\n\t        INNER JOIN t_user_role ON t_user_role.roleid = t_role.id\r\n        WHERE\r\n\t        t_role.id = #{id}\r\n    </delete>\r\n</mapper>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- ../sys-manager/src/main/java/com/zj/dao/SysDao.xml	(revision 935cd21e20a74c7c78d509369121f109c8831c57)
+++ ../sys-manager/src/main/java/com/zj/dao/SysDao.xml	(date 1635907722947)
@@ -113,6 +113,7 @@
         values (#{roleId},#{permId})
     </insert>
 
+<!--    删除角色-->
     <delete id="roleDelete">
         DELETE t_role,
             t_role_perms,
Index: ../sys-manager/src/main/java/com/zj/web/SysController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.zj.web;\r\n\r\nimport com.zj.annotation.IgnoreResponseAdvice;\r\nimport com.zj.entity.*;\r\nimport com.zj.service.SysService;\r\nimport com.zj.util.Md5;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\n\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport java.io.UnsupportedEncodingException;\r\nimport java.security.NoSuchAlgorithmException;\r\nimport java.util.List;\r\n\r\n/**\r\n * @author zhoujian\r\n */\r\n@RestController\r\n@RequestMapping(\"sys\")\r\n\r\npublic class SysController {\r\n    @Autowired\r\n    private SysService sysService;\r\n\r\n    /**\r\n     * 测试网关\r\n     * @return 测试网关\r\n     */\r\n    @IgnoreResponseAdvice\r\n    @RequestMapping(\"test\")\r\n    public String test(){\r\n        return \"test\";\r\n    }\r\n\r\n    /**\r\n     * 用户登录\r\n     * @return 用户对象\r\n     */\r\n    @PostMapping(\"login\")\r\n    public UserManager userLoginController(@RequestBody User user, HttpServletRequest request){\r\n        return sysService.userLoginService(user,request);\r\n    }\r\n\r\n    /**\r\n     * 公司查询，支持模糊查询和分页\r\n     * @param pageNo 页码\r\n     * @param pageSize 页面数据量\r\n     * @param orgName 查询关键字\r\n     * @return 结果集\r\n     */\r\n    @GetMapping(\"orga\")\r\n    public List<Organize> findOrganizeController(String pageNo,String pageSize,String orgName){\r\n        return sysService.findOrganzieService(pageNo,pageSize,orgName);\r\n    }\r\n\r\n    /**\r\n     * 添加机构\r\n     * @param organize 插入参数\r\n     * @return 插入是否成功\r\n     */\r\n    @PostMapping(\"orga\")\r\n    public CommonResponse<Object> addOrganizeController(@RequestBody Organize organize){\r\n        return  sysService.addOrganizeService(organize);\r\n    }\r\n\r\n    /**\r\n     * 角色查询\r\n     * @param pageNo 页码\r\n     * @param pageSize 每一个展示的数据\r\n     * @param roleName 查询关键字\r\n     * @return role结果集\r\n     */\r\n    @GetMapping(\"role\")\r\n    public List<Role> findRoleController(String pageNo,String pageSize,String roleName){\r\n        return sysService.findRoleService( pageNo, pageSize, roleName);\r\n    }\r\n\r\n    /**\r\n     * 添加角色\r\n     * @param role 添加对象参数\r\n     * @return 返回结果\r\n     */\r\n    @PostMapping(\"role\")\r\n    public CommonResponse<Object> addRoleController(@RequestBody Role role){\r\n        return sysService.addRoleService(role);\r\n    }\r\n\r\n    @DeleteMapping(\"role/{id}\")\r\n    public CommonResponse<Boolean> deleteRoleController(@PathVariable(\"id\") int id)throws Exception{\r\n        CommonResponse<Boolean> response = new CommonResponse<>();\r\n        boolean flag = sysService.deleteRoleService(id);\r\n        if (flag != false){\r\n            response.setMsg(\"删除成功1\");\r\n        }else {\r\n            response.setMsg(\"删除错误！\");\r\n        }\r\n        return response;\r\n    }\r\n    /**\r\n     * 权限查询\r\n     * @return 权限结果集\r\n     */\r\n    @GetMapping(\"perm\")\r\n    public List<Perm> findPermController(){\r\n        return sysService.findPermService();\r\n    }\r\n\r\n    @PostMapping(\"role/perm\")\r\n    public CommonResponse<Object> addRolePermController(String roleId,String permId){\r\n        return sysService.addRolePermService(roleId,permId);\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- ../sys-manager/src/main/java/com/zj/web/SysController.java	(revision 935cd21e20a74c7c78d509369121f109c8831c57)
+++ ../sys-manager/src/main/java/com/zj/web/SysController.java	(date 1635908222057)
@@ -3,13 +3,10 @@
 import com.zj.annotation.IgnoreResponseAdvice;
 import com.zj.entity.*;
 import com.zj.service.SysService;
-import com.zj.util.Md5;
 import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.web.bind.annotation.*;
 
 import javax.servlet.http.HttpServletRequest;
-import java.io.UnsupportedEncodingException;
-import java.security.NoSuchAlgorithmException;
 import java.util.List;
 
 /**
@@ -42,7 +39,7 @@
     }
 
     /**
-     * 公司查询，支持模糊查询和分页
+     * 机构查询，支持模糊查询和分页
      * @param pageNo 页码
      * @param pageSize 页面数据量
      * @param orgName 查询关键字
@@ -105,6 +102,12 @@
         return sysService.findPermService();
     }
 
+    /**
+     * 角色分配权限
+     * @param roleId
+     * @param permId
+     * @return
+     */
     @PostMapping("role/perm")
     public CommonResponse<Object> addRolePermController(String roleId,String permId){
         return sysService.addRolePermService(roleId,permId);
Index: ../sys-manager/src/main/java/com/zj/dao/SysDao.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.zj.dao;\r\n\r\nimport com.zj.entity.*;\r\nimport org.springframework.stereotype.Repository;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * @author zhoujian\r\n */\r\n@Repository\r\npublic interface SysDao {\r\n    /**\r\n     * 根据username和password查询用户\r\n     */\r\n    UserManager userSelect(User user);\r\n\r\n    /**\r\n     *\r\n     * 根据公司的名字模糊查询，使用到分页\r\n     */\r\n    List<Organize> organizeSelect(String orgName);\r\n\r\n    /**\r\n     * 机构插入\r\n     * @param organize\r\n     * @return\r\n     */\r\n    boolean organizeInsert(Organize organize);\r\n\r\n    /**\r\n     * 查询角色，支持模糊查询\r\n     * @return\r\n     */\r\n    List<Role> roleSelect();\r\n\r\n    /**\r\n     * 根据id删除角色\r\n     */\r\n    boolean roleDelete(int id);\r\n    List<Role> roleSelect(String roleName);\r\n\r\n    /**\r\n     * 角色插入\r\n     * @param role 插入参数\r\n     * @return 返回结果\r\n     */\r\n    boolean roleInsert(Role role);\r\n\r\n    /**\r\n     * 查询所有的权限\r\n     * @return 返回结果集\r\n     */\r\n    List<Perm> permSelect();\r\n\r\n    boolean rolePermInsert(String roleId, String permId);\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- ../sys-manager/src/main/java/com/zj/dao/SysDao.java	(revision 935cd21e20a74c7c78d509369121f109c8831c57)
+++ ../sys-manager/src/main/java/com/zj/dao/SysDao.java	(date 1635907722965)
@@ -38,6 +38,12 @@
      * 根据id删除角色
      */
     boolean roleDelete(int id);
+
+    /**
+     * 查询角色
+     * @param roleName
+     * @return
+     */
     List<Role> roleSelect(String roleName);
 
     /**
Index: ../sys-manager/target/classes/com/zj/dao/SysDao.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<!DOCTYPE mapper\r\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\r\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.zj.dao.SysDao\">\r\n<!--    用户登录sql-->\r\n    <resultMap id=\"user_map\" type=\"com.zj.entity.UserManager\">\r\n<!--        用户信息-->\r\n        <id column=\"id\" property=\"id\"/>\r\n        <result column=\"username\" property=\"username\"/>\r\n        <result column=\"password\" property=\"password\"/>\r\n        <result column=\"salt\" property=\"salt\"/>\r\n        <result column=\"phone\" property=\"phone\"/>\r\n<!--        用户所在的公司-->\r\n        <association property=\"o\" javaType=\"com.zj.entity.Organize\">\r\n            <id column=\"id\" property=\"id\"/>\r\n            <result column=\"organame\" property=\"name\"/>\r\n        </association>\r\n<!--       用户____> 角色表____>角色实体集 -->\r\n        <collection property=\"roles\" ofType=\"com.zj.entity.Role\">\r\n            <result column=\"rolename\" property=\"name\"/>\r\n            <result column=\"ext\" property=\"ext\"/>\r\n<!--         角色表____>权限表_____>权限实体集-->\r\n            <collection  property=\"perms\" ofType=\"com.zj.entity.Perm\">\r\n                <result column=\"permname\" property=\"name\"/>\r\n            </collection>\r\n        </collection>\r\n    </resultMap>\r\n    <select id=\"userSelect\" resultMap=\"user_map\">\r\n        SELECT\r\n            u.id,\r\n            u.username,\r\n            u.password,\r\n            u.salt,\r\n            u.phone,\r\n            o.NAME AS organame,\r\n            r.NAME AS rolename,\r\n            r.ext,\r\n            p.NAME AS permname\r\n        FROM\r\n            t_user u\r\n            LEFT JOIN organize o ON o.id = u.orga_id\r\n            LEFT JOIN t_user_role ur ON ur.userid = u.id\r\n            LEFT JOIN t_role r ON r.id = ur.roleid\r\n            LEFT JOIN t_role_perms rp ON rp.role_id = r.id\r\n            LEFT JOIN t_perms p ON p.id = rp.perm_id\r\n        where\r\n            u.username = #{username} and  u.password= #{password}\r\n    </select>\r\n\r\n<!--    机构查询根据机构名称模糊查询，支持分页，page-->\r\n    <resultMap id=\"orga_type_map\" type=\"com.zj.entity.Organize\">\r\n        <id column=\"id\" property=\"id\"/>\r\n        <result column=\"name\" property=\"name\"/>\r\n<!--        公司的父公司-->\r\n        <result column=\"parentorganame\" property=\"parentName\"/>\r\n       <result column=\"location\" property=\"location\"/>\r\n        <result column=\"organum\" property=\"orgaNumber\"/>\r\n        <result column=\"ext\" property=\"ext\"/>\r\n<!--        公司的类型-->\r\n        <association property=\"orgaType\" javaType=\"com.zj.entity.OrgaType\">\r\n            <result column=\"orgatypename\" property=\"name\"/>\r\n        </association>\r\n    </resultMap>\r\n    <select id=\"organizeSelect\" resultMap=\"orga_type_map\" >\r\n    SELECT\r\n        o1.id,\r\n        o1.name,\r\n        o2.name as parentorganame,\r\n        ot.name as orgatypename,\r\n        o1.location,\r\n        o1.orga_number as organum,\r\n        o1.ext\r\n    FROM\r\n        organize o1\r\n        JOIN orga_type ot ON ot.id = o1.id\r\n        left join organize o2 on o2.id = o1.parent_id\r\n\twhere o1.name like concat(#{orgName},'%')\r\n    </select>\r\n\r\n<!--    机构插入-->\r\n    <insert id=\"organizeInsert\" >\r\n        insert  into organize\r\n        (name , parent_id, type_id, location, orga_number, ext)\r\n        values\r\n        (#{name},#{parentId},#{typeId},#{location},#{orgaNumber},#{ext})\r\n    </insert>\r\n\r\n<!--    查询角色-->\r\n<<<<<<< HEAD\r\n    <select id=\"roleSelect\" >\r\n\r\n=======\r\n    <select id=\"roleSelect\" resultType=\"com.zj.entity.Role\">\r\n        select\r\n        id,name,ext from t_role\r\n        where name like concat(#{roleName},'%')\r\n    </select>\r\n\r\n<!--    新增角色-->\r\n    <insert id=\"roleInsert\" parameterType=\"com.zj.entity.Role\">\r\n        insert into t_role\r\n        (name,ext)\r\n        values\r\n        (#{name},#{ext})\r\n    </insert>\r\n\r\n<!--    查询所用的权限-->\r\n    <select id=\"permSelect\" resultType=\"com.zj.entity.Perm\">\r\n        select id,name from t_perms\r\n>>>>>>> 0491714528170b9f844022b2a18bca62910ba1c4\r\n    </select>\r\n\r\n<!--    角色权限添加-->\r\n    <insert id=\"rolePermInsert\" >\r\n        insert into t_role_perms\r\n        (role_id,perm_id)\r\n        values (#{roleId},#{permId})\r\n    </insert>\r\n</mapper>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- ../sys-manager/target/classes/com/zj/dao/SysDao.xml	(revision 935cd21e20a74c7c78d509369121f109c8831c57)
+++ ../sys-manager/target/classes/com/zj/dao/SysDao.xml	(date 1635907722947)
@@ -87,10 +87,6 @@
     </insert>
 
 <!--    查询角色-->
-<<<<<<< HEAD
-    <select id="roleSelect" >
-
-=======
     <select id="roleSelect" resultType="com.zj.entity.Role">
         select
         id,name,ext from t_role
@@ -98,7 +94,7 @@
     </select>
 
 <!--    新增角色-->
-    <insert id="roleInsert" parameterType="com.zj.entity.Role">
+    <insert id="RoleInsert" >
         insert into t_role
         (name,ext)
         values
@@ -108,7 +104,6 @@
 <!--    查询所用的权限-->
     <select id="permSelect" resultType="com.zj.entity.Perm">
         select id,name from t_perms
->>>>>>> 0491714528170b9f844022b2a18bca62910ba1c4
     </select>
 
 <!--    角色权限添加-->
@@ -117,4 +112,17 @@
         (role_id,perm_id)
         values (#{roleId},#{permId})
     </insert>
+
+<!--    删除角色-->
+    <delete id="roleDelete">
+        DELETE t_role,
+            t_role_perms,
+            t_user_role
+        FROM
+	    t_role
+	        INNER JOIN t_role_perms ON t_role_perms.role_id = t_role.id
+	        INNER JOIN t_user_role ON t_user_role.roleid = t_role.id
+        WHERE
+	        t_role.id = #{id}
+    </delete>
 </mapper>
\ No newline at end of file
